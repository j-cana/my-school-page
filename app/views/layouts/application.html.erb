<!DOCTYPE html>
<html>
  <head>
    <title>Mynewapplication</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <style>

      .navbar {
        background-color: #000 !important;
      }

      .navbar-brand,
      .nav-link {
        font-size: 20px;
        color: #f1f1f1 !important;
        font-weight: 500;
      }

      .nav-link:hover {
        color: #ffd700 !important;
      }


      .sidebar {
        height: 100%;
        width: 250px;
        position: fixed;
        top: 0;            
        left: -250px;
        background-color: #111;
        color: white;
        transition: 0.3s;
        padding-top: 60px;
        z-index: 3000;
      }

      .sidebar a {
        display: block;
        color: #ffce1b;
        padding: 12px 20px;
        text-decoration: none;
        font-weight: 500;
        transition: 0.2s;
      }

      .sidebar a:hover {
        background-color: #333;
        color: #ffd700;
      }

      .sidebar.active {
        left: 0;
      }

      .open-btn {
        font-size: 26px;
        border: none;
        background: none;
        color: #ffce1b;
        cursor: pointer;
        position: relative;
      }

      body.sidebar-open {
        overflow: hidden;
      }

      #overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 2000;
      }

      #overlay.active {
        display: block;
      }
    </style>
  </head>

  <body>
    <!-- ðŸ”¹ Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
      <div class="container-fluid">
        <button class="open-btn" id="menuBtn">&#9776;</button>
        <a class="navbar-brand ms-2" href="#">School Manager</a>
      </div>
    </nav>

    <!-- ðŸ”¹ Sidebar -->
    <div class="sidebar" id="sidebar">
      <a href="<%= root_path %>">Home</a>
      <a href="<%= students_path %>">Students</a>
      <a href="<%= teachers_path %>">Teachers</a>
      <a href="<%= departments_path %>">Departments</a>
      <a href="<%= subjects_path %>">Subjects</a>
      <a href="<%= sections_path %>">Sections</a>
      <a href="<%= classlists_path %>">Classlists</a>
      <a href="<%= guardians_path %>">Guardians</a>
      <a href="<%= student_guardians_path %>">Relationships</a>
    </div>

    <div id="overlay"></div>

    <!-- ðŸ”¹ Flash Messages -->
    <% flash.each do |key, message| %>
      <div class="alert alert-<%= key == "notice" ? "success" : "danger" %> alert-dismissible fade show m-3" role="alert">
        <%= message %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    <% end %>

    <div>
      <%= yield %>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ðŸ”¹ Sidebar Toggle Script -->
    <script>
  document.addEventListener("turbo:load", () => {
    const menuBtn = document.getElementById("menuBtn");
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");

    if (!menuBtn || !sidebar || !overlay) return;


    menuBtn.replaceWith(menuBtn.cloneNode(true));
    overlay.replaceWith(overlay.cloneNode(true));

    const newMenuBtn = document.getElementById("menuBtn");
    const newOverlay = document.getElementById("overlay");

    function openSidebar() {
      sidebar.classList.add("active");
      newOverlay.classList.add("active");
      document.body.classList.add("sidebar-open");
    }

    function closeSidebar() {
      sidebar.classList.remove("active");
      newOverlay.classList.remove("active");
      document.body.classList.remove("sidebar-open");
    }

    newMenuBtn.addEventListener("click", () => {
      sidebar.classList.contains("active") ? closeSidebar() : openSidebar();
    });

    newOverlay.addEventListener("click", closeSidebar);

    sidebar.querySelectorAll("a").forEach(link => {
      link.addEventListener("click", closeSidebar);
    });
  });
</script>


  </body>
</html>